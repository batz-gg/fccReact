# Веб Гүйцэтгэлийн Тойм

## Бодит ба Ойлгогдох Гүйцэтгэлийн Ялгаа

* **Ойлгогдох Гүйцэтгэл (Perceived Performance)**: Энэ нь хэрэглэгчид вебсайтын гүйцэтгэлийг хэрхэн хүлээж авч байгааг илэрхийлнэ. Тэд үүнийг хариу үйлдэл үзүүлэх хурд болон найдвартай байдлаар нь үнэлдэг. Энэ нь субъектив хэмжүүр тул тоон утгаар илэрхийлэхэд хэцүү боловч хэрэглэгчийн туршлага нь вебсайтын амжилт эсвэл бүтэлгүйтлийг тодорхойлдог тул маш чухал юм.
* **Бодит Гүйцэтгэл (Real Performance)**: Энэ нь вебсайтын бодитой, хэмжигдэхүйц гүйцэтгэл юм. Үүнийг хуудас ачаалах хугацаа, серверийн хариу өгөх хугацаа, дүрслэн харуулах (rendering) хугацаа зэрэг хэмжүүрүүдээр хэмждэг. Эдгээр хэмжилтүүдэд сүлжээ болон кодтой холбоотой олон хүчин зүйлс нөлөөлдөг.

## Ойлгогдох Гүйцэтгэлийг Сайжруулах Техникүүд

* **Lazy Loading (Залхуу Ачаалалт)**: Энэ техник нь чухал бус нөөцүүдийг далд (background) хэлбэрээр ачаалах замаар анхны ачаалах хугацааг аль болох багасгадаг.
* **Фонтын саатлыг багасгах**: Хэрэв таны вебсайт тусгай фонттой бол фонт ачаалах саатлыг багасгахыг хичээх хэрэгтэй. Учир нь энэ нь анивчих эсвэл тусгай фонт ачаалагдах үед нөөц фонт харагдахад хүргэж болзошгүй. Үүнийг шийдэх нэг арга бол тусгай фонттой төстэй нөөц фонт ашиглах явдал юм. Ингэснээр өөрчлөлт гарах үед ялгаа нь бага мэдрэгдэх болно.
* **Ачаалах үзүүлэлт ашиглах**: Хэрэглэгч ямар нэгэн элемент дээр дармагц удаан үргэлжлэх процессийн хувьд ачаалах үзүүлэлтийг харуулах нь хэрэглэгчийг процесстой холбоотой, оролцоотой мэт сэтгэгдэл төрүүлж, хүлээх хугацааг богино мэт санагдуулна.

## Гүйцэтгэлийн Үндсэн Ойлголтууд

* **Эх кодын дараалал (Source order)**: Энэ нь HTML элементүүд баримт бичигт хэрхэн бүтэцлэгдсэнийг хэлнэ. Энэ нь юу түрүүлж ачаалагдахыг тодорхойлдог бөгөөд гүйцэтгэл болон хүртээмжид ихээхэн нөлөөлдөг.

Эх кодын дарааллын шилдэг туршлагуудаас дурдвал:

* Гарчиг, навигаци эсвэл үндсэн текст зэрэг чухал агуулгыг HTML бүтцийн дээд хэсэгт байрлуулах.
* Аналитик эсвэл гуравдагч талын виджет зэрэг чухал бус скриптүүдийг хойшлуулж, дүрслэлд саад учруулахгүй байх.
* Загвар болон скриптүүд ачаалагдахаас өмнө үндсэн туршлага ажиллаж байгааг баталгаажуулахын тулд "progressive enhancement" (дэвшилтэт сайжруулалт) ашиглах. Progressive enhancement нь хуудсаа эхлээд HTML дээр ажилладаг болгох санаан дээр суурилж вебсайт, аппликейшн бүтээх арга юм.

Бидний дөнгөж сая үзсэн шилдэг туршлагуудыг ашигласан сайн эх кодын дарааллын жишээ энд байна:

```html
<h1>Welcome to FastSite!</h1>
<p>Critical information loads first.</p>
<script src="slow-script.js" defer></script>
```

* **Critical Rendering Path (Чухал Дүрслэх Зам)**: Энэ нь хөтөч кодыг дэлгэцэн дээрх пиксел болгон хувиргахын тулд дагаж мөрддөг алхмуудын дараалал юм.
* **Хоцрогдол (Latency)**: Энэ нь хүсэлт хөтөч болон серверийн хооронд дамжих хугацаа юм. Өөрөөр хэлбэл, өндөр хоцрогдол нь удаан хуудас гэсэн үг.

Хоцрогдлыг бууруулах зарим аргууд:

* Файлуудыг ойр байршлаас хүргэхийн тулд CDN буюу Агуулга Хүргэх Сүлжээг ашиглах.
* Файлын хэмжээг багасгахын тулд Gzip зэрэг шахалтыг идэвхжүүлэх.
* Зургийг оновчтой болгох болон lazy loading ашиглах.

```html
<img src="placeholder.jpg" data-src="real-image.jpg" loading="lazy">
```

## INP-ийг Сайжруулах

* **Тодорхойлолт**: INP (Interaction to Next Paint) нь хэрэглэгч товшилт эсвэл товчлуур дарах зэрэг үйлдэл хийснээс хойш хөтөч дэлгэцийг шинэчлэх хүртэлх хугацааг хэмжих замаар хуудасны ерөнхий хариу үйлдэл үзүүлэх чадварыг үнэлдэг. Бага INP нь илүү хурдан хариу үйлдэл үзүүлдэг хуудсыг илтгэнэ.

INP-ийг сайжруулах зарим аргууд:

* Урт JavaScript даалгавруудыг хуваах замаар үндсэн thread-ийн ажлыг багасгах.
* Чухал бус скриптүүдэд `requestIdleCallback()` ашиглах. Энэ нь хөтчийн сул зогсолтын үед дуудагдах функцийг дараалалд оруулна.
* Өмнө дурдсан хүнд нөөцүүдийг хойшлуулах эсвэл lazy-load хийх.
* Event handler-уудыг оновчтой болгох. Хэрэв эдгээр handler-ууд хэт олон удаа ажиллах эсвэл хүнд үйлдэл хийвэл хуудсыг удаашруулж, INP-ийг нэмэгдүүлдэг. Үүний шийдэл нь debouncing юм. Debouncing нь хэрэглэгч шивж дууссаны дараа богино хугацааны (жишээ нь 300мс) дараа л функц ажиллахыг баталгаажуулдаг. Энэ нь шаардлагагүй тооцооллоос сэргийлж, гүйцэтгэлийг сайжруулдаг.

## Хөтөч дээр Дүрслэл Хэрхэн Явагддаг вэ

* **Дүрслэл хэрхэн ажилладаг вэ**: Эхлээд хөтөч HTML-ийг задлан шинжилж DOM-ийг бүтээнэ. Дараа нь хөтөч CSS-ийг боловсруулж, CSS Object Model буюу CSSOM-ийг бүтээнэ. Энэ нь элементүүд хэрхэн загварчлагдахыг заадаг өөр нэг мод бүтэц юм. Эцэст нь хөтөч тооцоолсон загвар болон байршил дээр үндэслэн элемент бүрийг дүрсэлж, дэлгэцэн дээр пикселүүдийг зурдаг. Нарийн төвөгтэй хуудсуудад энэ нь эцсийн харагдах байдлыг бүрдүүлэхийн тулд нэгтгэгдсэн олон давхаргыг хамарч болно.

## Гүйцэтгэл Тогтвортой Байдалд Хэрхэн Нөлөөлдөг вэ

* **Ерөнхий мэдээлэл**: Интернет нь дэлхийн нүүрстөрөгчийн ялгарлын 2 орчим хувийг эзэлдэг бөгөөд энэ нь агаарын тээврийн салбартай ижил хэмжээ юм! Дамжуулагдсан байт бүр дата төвөөс эхлээд хэрэглэгчийн төхөөрөмж хүртэл цахилгаан шаарддаг. Том файлууд болон үр ашиггүй скриптүүд нь илүү их эрчим хүч зарцуулна гэсэн үг. Өндөр гүйцэтгэлтэй вебсайт нь зөвхөн хурдан байгаад зогсохгүй шаардлагагүй боловсруулалт болон эрчим хүчний хэрэглээг бууруулдаг.

## Хуудас Ачаалах Хугацааг Бууруулах Аргууд

* **Медиа хөрөнгийг оновчтой болгох**: Том зураг болон видеонууд нь ачаалах хугацааг удаашруулдаг нийтлэг шалтгаан болдог. Эдгээр хөрөнгийг оновчтой болгосноор та сайтаа мэдэгдэхүйц хурдасгах боломжтой. Үүнд зургийг шахах, WebP зэрэг орчин үеийн форматуудыг ашиглах, хөрөнгүүдэд lazy loading ашиглах зэрэг орно.
* **Хөтчийн кэшийг ашиглах**: Кэш нь хөтчүүдэд таны вебсайтын хэсгүүдийг дотооддоо хадгалах боломжийг олгож, дахин зочилж буй хэрэглэгчдийн ачаалах хугацааг багасгадаг.
* **Файлуудыг жижигрүүлэх ба шахах**: Файлын хэмжээг багасгах нь татан авалтыг хурдасгахад хүргэнэ. Үүнд дамжуулагдсан файлын хэмжээг багасгах, CSS болон JavaScript файлуудыг жижигрүүлэх (minify) зэрэг орно.

## "Ашиглах боломжтой болох хугацаа"-г Сайжруулах

* **Тодорхойлолт**: "Ашиглах боломжтой болох хугацаа" (time to usable) нь хэрэглэгч хуудсыг хүсэхээс эхлээд түүнтэй утга учиртай харилцах боломжтой болох хүртэлх хугацаа юм. "Ашиглах боломжтой болох хугацаа"-г сайжруулахын тулд та хөрөнгөө lazy load хийх эсвэл дүрслэлд саад болох нөөцүүдийг багасгах боломжтой.

## Гүйцэтгэлийг Хэмжих Гол Хэмжүүрүүд

* **First Contentful Paint буюу FCP**: Энэ нь дэлгэцэн дээр текстийн эсвэл зургийн эхний хэсэг хэр хурдан гарч ирж байгааг хэмждэг. Сайн FCP нь 1.8 секундээс бага хугацаа гэж тооцогддог бол муу FCP нь 3 секундээс дээш байдаг. Та Chrome DevTools-ийн performance табыг ашиглан өөрийн FCP-ийг шалгаж болно.
* **Total Blocking Time (Нийт Блоклох Хугацаа)**: Энэ нь хүнд JavaScript даалгавруудаар үндсэн thread хэр удаан блоклогдсоныг харуулдаг. Хэрэв Total Blocking Time (TBT) өндөр байвал хэрэглэгчид удаан хариу үйлдэл мэдрэх болно. TBT-ийг сайжруулахын тулд урт даалгавруудыг хувааж, чухал бус скриптүүдийг хойшлуулах хэрэгтэй.
* **Bounce Rate (Ороод гарах хувь)**: Энэ нь ямар ч үйлдэл хийлгүйгээр гарч буй зочдын хувь юм. Хэрэв таны сайт өндөр bounce rate-тэй байвал энэ нь таны хуудас хэт удаан байгаатай холбоотой байж магадгүй.
* **Unique Users (Давтагдашгүй Хэрэглэгчид)**: Энэ хэмжүүр нь таны сайтад хэдэн хувь хүн зочилж байгааг хянадаг. Bounce Rate болон Unique Users-ийг харахын тулд та Google Analytics ашиглаж болно. Энэ нь эдгээр хэмжүүрүүдийг хянаж, оролцоог сайжруулах боломжийг олгоно.

## Гүйцэтгэл Хэмжих Нийтлэг Хэрэгслүүд

* **Chrome DevTools**: Chrome DevTools нь Google Chrome доторх суулгагдсан хэрэгсэл бөгөөд гүйцэтгэлийг бодит цаг хугацаанд шинжлэх, дибаг хийх боломжийг олгодог. DevTools нь ачаалах хугацаа, CPU-ийн ашиглалт, дүрслэлийн саатлыг харуулна. Энэ нь ялангуяа First Contentful Paint буюу FCP-ийг хэмжихэд тустай бөгөөд хэрэглэгч анхны харагдах агуулгыг хэр хурдан харж байгааг хэмждэг. Хэрэв таны вебсайт удаан санагдаж байвал DevTools танд гацааг олоход тусална.
* **Lighthouse**: Энэ нь гүйцэтгэл, SEO болон хүртээмжийг шалгадаг автоматжуулсан хэрэгсэл юм.
* **WebPageTest**: Энэ хэрэгсэл нь таны сайт өөр өөр байршил, төхөөрөмжөөс хэрхэн ачаалагдаж байгааг шалгах боломжийг олгодог. Энэ хэрэгсэл нь таны сайтын Speed Index, Total Blocking Time болон бусад гүйцэтгэлийн гол хэмжүүрүүдийн нарийвчилсан задаргааг өгдөг. Хэрэв та дэлхий даяарх бодит хэрэглэгчид таны сайтыг хэрхэн мэдэрч байгааг мэдэхийг хүсвэл WebPageTest бол тохирох хэрэгсэл юм.
* **PageSpeed Insights**: Энэ хэрэгсэл нь таны вебсайтад дүн шинжилгээ хийж, гар утас болон десктопт зориулсан хурдан сайжруулалтуудыг санал болгодог. Энэ нь таны сайтыг юу удаашруулж байгааг хэлж өгөхөөс гадна зургийг оновчтой болгох, дүрслэлд саад болж буй скриптүүдийг арилгах, серверийн хариу өгөх хугацааг багасгах зэрэг тодорхой зөвлөмжүүдийг өгдөг. PageSpeed Insights нь Google таны сайтын гүйцэтгэлийг хэрхэн харж байгааг шалгах хурдан бөгөөд хялбар арга юм.
* **Real User Monitoring (Бодит Хэрэглэгчийн Хяналт)**: RUM хэрэгслүүд нь хэрэглэгчийн бодит зан төлөвийг хянаж, бодит зочид таны сайтыг хэрхэн мэдэрч байгааг харуулдаг. Алдартай RUM хэрэгслүүдэд хуудас ачаалах хугацаа болон bounce rate-ийг хянадаг Google Analytics, мөн бодит цагийн гүйцэтгэлийн асуудлыг хянадаг New Relic эсвэл Datadog орно. Хэрэв та бодит хэрэглэгчдээс мэдээлэл авахыг хүсвэл RUM хэрэгслүүд зайлшгүй шаардлагатай.

## Performance Web API-тай Ажиллах

* **Тодорхойлолт**: Performance Web API-ууд нь хөгжүүлэгчдэд веб хуудас хэр үр дүнтэй ачаалагдаж, хариу үйлдэл үзүүлж байгааг кодон дотроо шууд хянах боломжийг олгодог. Эдгээр API нь хуудас ачаалах хугацааг хэмжих, дүрслэл болон харилцан үйлчлэлийн саатлыг хянах, JavaScript гүйцэтгэх хугацааг шинжлэх боломжийг олгодог.
* **`performance.now()`**: Энэ API нь таны сайтын өөр өөр хэсгүүд ачаалагдахад хэр хугацаа зарцуулж байгааг хэмжихийн тулд өндөр нарийвчлалтай цагийн тэмдэглэгээг (миллисекундээр) өгдөг.

```js
const start = performance.now();  
// Run some code here  
const end = performance.now();  

console.log(`Execution time: ${end - start}ms`);
```

* **Performance Timing API**: Энэ API нь DNS хайлтаас эхлээд `DOMContentLoaded` хүртэлх хуудас ачаалах үе шат бүрийн задаргааг өгдөг.

```js
const timing = performance.timing;  

const pageLoadTime = timing.loadEventEnd - timing.navigationStart;  
console.log(`Page load time: ${pageLoadTime}ms`);
```

* **`PerformanceObserver`**: Энэ API нь layout shift (бүтцийн шилжилт), урт даалгавар, хэрэглэгчийн харилцан үйлчлэл зэрэг гүйцэтгэлийн үйл явдлуудыг сонсдог.

```js
const observer = new PerformanceObserver((list) => {  
  list.getEntries().forEach((entry) => {  
    console.log(`Long task detected: ${entry.duration}ms`);  
  });  
});  

observer.observe({ type: "longtask", buffered: true });
```

## CSS Гүйцэтгэлийг Сайжруулах Техникүүд

* **CSS Анимэйшн**: Хэмжээ, байршил, бүтэц зэрэг тодорхой CSS шинж чанаруудыг хөдөлгөөнд оруулах нь "reflow" гэж нэрлэгддэг процессыг өдөөдөг бөгөөд энэ үед хөтөч хуудсан дээрх тодорхой элементүүдийн байршил, геометрийг дахин тооцоолдог. Энэ нь дахин зурах (repaint) шаардлагатай болдог тул тооцооллын хувьд өндөр зардалтай байдаг. Тиймээс CSS анимэйшний тоог аль болох багасгах эсвэл ядаж хэрэглэгчдэд тэдгээрийг асаах, унтраах сонголтыг өгөх нь зүйтэй.

## JavaScript Гүйцэтгэлийг Сайжруулах Техникүүд

* **Code Splitting (Код Хуваах)**: JavaScript кодоо чухал болон чухал бус даалгавруудыг гүйцэтгэдэг модулиудад хуваах нь бас тустай. Ингэснээр та чухал модулиудыг аль болох хурдан урьдчилан ачаалж, чухал бус модулиудыг хойшлуулснаар хуудсыг аль болох хурдан дүрслэх боломжтой болно.
* **DOM Manipulation (DOM-ийн Өөрчлөлт)**: DOM Manipulation гэдэг нь Document Object Model (DOM)-той харилцах замаар JavaScript ашиглан хуудасны агуулгыг динамикаар өөрчлөх үйл явцыг хэлдгийг санаарай. DOM-ийг өөрчлөх нь тооцооллын хувьд өндөр зардалтай байдаг. JavaScript код дахь DOM өөрчлөлтийн хэмжээг багасгаснаар гүйцэтгэлийг сайжруулах болно.
